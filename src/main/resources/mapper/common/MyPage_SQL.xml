<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mypage">
		<select id="myinfoDetail" parameterType="String" resultType="hashmap">
			<![CDATA[
				SELECT * FROM MEMBER WHERE MEMBER_ID=#{MEMBER_ID}
			]]>
		</select>
		<select id="selectOtoList" parameterType="String" resultType="hashmap">
		     <![CDATA[
		     	SELECT * FROM QNA WHERE MEMBER_NUMBER = #{MEMBER_NUMBER} AND NOT QNA_CATEGORY='상품문의' order by qna_number desc
		     ]]>
		</select>
		<select id="selectOtoComplete" parameterType="String" resultType="hashmap">
			<![CDATA[
				SELECT * FROM QNA WHERE MEMBER_NUMBER = #{MEMBER_NUMBER} AND QNA_REPSTATE='문의종료' AND NOT QNA_CATEGORY='상품문의' order by qna_number desc
			]]>
		</select>
		<select id="selectOtoCount" parameterType="String" resultType="int">
		<![CDATA[
				SELECT COUNT(*) FROM QNA WHERE MEMBER_NUMBER = #{MEMBER_NUMBER} AND NOT QNA_CATEGORY = '상품문의'
						]]>
		</select>
		<update id="updateMyinfo" parameterType="hashmap">
		<![CDATA[
			UPDATE MEMBER SET MEMBER_PHONE=#{MEMBER_PHONE}, MEMBER_ZIPCODE=#{MEMBER_ZIPCODE}, MEMBER_ADDRESS1=#{MEMBER_ADDRESS1}, 
			MEMBER_ADDRESS2=#{MEMBER_ADDRESS2}, MEMBER_EMAIL=#{MEMBER_EMAIL} WHERE MEMBER_ID=#{MEMBER_ID}
		]]>
		</update>
		
		<select id="selectReviewList" parameterType="String" resultType="hashmap">
		<![CDATA[
		select A.REVIEW_NUMBER, A.GOODS_NUMBER, A.GOODS_NAME, A.GOODS_THUMBNAIL, A.REVIEW_TITLE, A.REVIEW_REGDATE, 
		A.REVIEW_IMAGE, A.REVIEW_CONTENT, A.REVIEW_GRADE, A.MEMBER_NUMBER FROM (SELECT * FROM review NATURAL JOIN goods) A 
		WHERE MEMBER_NUMBER = #{MEMBER_NUMBER} ORDER BY REVIEW_NUMBER DESC
		]]>
		</select>
		
		<select id="selectOrderList" parameterType="String" resultType="hashmap">
		<![CDATA[
		SELECT * FROM (SELECT * FROM ORDERLIST NATURAL JOIN GOODS) A WHERE MEMBER_NUMBER = #{MEMBER_NUMBER}
		]]>
		</select>
		
		<update id="changePassword" parameterType="hashmap">
		<![CDATA[
			UPDATE MEMBER SET MEMBER_PASSWORD = #{MEMBER_PASSWORD} WHERE MEMBER_ID=#{MEMBER_ID}
		]]>
		</update>
</mapper>